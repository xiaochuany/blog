
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="life is short">
      
      
      
        <link rel="canonical" href="https://xiaochuany.github.io/blog/2025/02/15/survive/">
      
      
        <link rel="prev" href="../../../01/12/intro-to-jax/">
      
      
        <link rel="next" href="../../../04/05/fork-merge-and-pr/">
      
      
        
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>The Cox survival guide: hazards, models and time - Xiaochuan's blog</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-VQFRTKQCML"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-VQFRTKQCML",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-VQFRTKQCML",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-cox-survival-guide-hazards-models-and-time" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Xiaochuan&#39;s blog" class="md-header__button md-logo" aria-label="Xiaochuan's blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Xiaochuan's blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The Cox survival guide: hazards, models and time
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Xiaochuan&#39;s blog" class="md-nav__button md-logo" aria-label="Xiaochuan's blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Xiaochuan's blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tags
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2026/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2026
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/til/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TIL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-hazard" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is hazard?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#right-cencoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        Right-cencoring
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cox-proportional-hazard-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cox proportional hazard model
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluating-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evaluating models
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../.." class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="https://avatars.githubusercontent.com/u/63112811?v=4" alt="Xiaochuan Yang">
                    </span>
                    <span class="md-profile__description">
                      <strong>
                        
                          Xiaochuan Yang
                        
                      </strong>
                      <br>
                      Author
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2025-02-15 00:00:00+00:00" class="md-ellipsis">February 15, 2025</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
                          <span class="md-ellipsis">
                            in
                            
                              <a href="../../../../category/analysis/">Analysis</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              7 min read
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  


  <nav class="md-tags" >
    
      
      
      
      
        <a href="../../../../tags/#tag:quant-methods" class="md-tag">quant methods</a>
      
    
  </nav>



<h1 id="the-cox-survival-guide-hazards-models-and-time">The Cox survival guide: hazards, models and time</h1>
<!-- more -->

<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<p>This note is an overview of survival analysis with a focus on the Cox proportional hazards model, a key tool for modelling time-to-event data. We define hazard functions, address right-censoring, and derive estimators like Nelson-Aalen and Kaplan-Meier. The Cox model's semiparametric form and partial likelihood estimation are discussed, along with evaluation metrics such as concordance probability.</p>
</div>
<h2 id="what-is-hazard">What is hazard?</h2>
<p>The cumulative hazard function for a time-to-event (e.g. death in medical trials) distribution can be defined in the most generality using the Lebesgue-Stieltjes integral,
which accommodates both continuous and discrete distributions and more.</p>
<p>For a survival time <span class="arithmatex">\( T \)</span> with survival function <span class="arithmatex">\( S(t) = P(T &gt; t) \)</span>, the cumulative hazard function <span class="arithmatex">\( H(t) \)</span> is defined as:</p>
<div class="arithmatex">\[
H(t) = \int_0^t \frac{dF(s)}{S(s^-)},
\]</div>
<p>where <span class="arithmatex">\( F(s) = P(T \leq s) \)</span> and <span class="arithmatex">\( S(s^-) = \lim_{u \uparrow s} S(u) = P[T\ge s] \)</span> is the left-continuous survival function.
Here the integral is a Lebesgue-Stieltjes integral (TLDR this makes sense because F is monotone thus of finite variation).</p>
<p><strong>Continuous Distributions</strong>:</p>
<p>If <span class="arithmatex">\( T \)</span> is a continuous random variable with density <span class="arithmatex">\(f\)</span>, then <span class="arithmatex">\( S(s^-) = S(s) \)</span> and the cumulative hazard reduces to</p>
<div class="arithmatex">\[
\begin{align}
H(t) &amp;= \int_0^t h(s) ds \notag\\
h(t) &amp;= \frac{f(t)}{S(t)} \label{e-hazard-func}
\end{align}
\]</div>
<p>Notice that <span class="arithmatex">\(f(t)=-S'(t)\)</span> so by <span class="arithmatex">\(\eqref{e-hazard-func}\)</span> the survival function satisfies the ODE</p>
<div class="arithmatex">\[h(t) = - S'(t)/S(t)\]</div>
<p>with boundary values <span class="arithmatex">\(S(0)=1, S(\infty)=0\)</span>. One concludes that <span class="arithmatex">\( S(t) = \exp(-H(t)) \)</span>.
 Given an estimator of <span class="arithmatex">\(H\)</span> or <span class="arithmatex">\(h\)</span>, one can estimate <span class="arithmatex">\(S\)</span> through this relation.</p>
<p><strong>Discrete Distributions</strong>:</p>
<p>If <span class="arithmatex">\( T \)</span> is discrete with support <span class="arithmatex">\(\{ t_1, t_2, \dots \}\)</span>, the cumulative hazard is a sum over discrete hazards:</p>
<div class="arithmatex">\[
H(t) = \sum_{t_j \leq t} h(t_j), \quad \text{where } h(t_j) =  \frac{F(t_j)-F(t_j^-)}{P[T\ge t_j]} =  P[T = t_j \mid T \geq t_j].
\]</div>
<p>We can and will assume that <span class="arithmatex">\(t_1&lt;t_2&lt;t_3\)</span> and so on. Any <span class="arithmatex">\(t\ge t_1\)</span> there exists a unique <span class="arithmatex">\(j\)</span> such that <span class="arithmatex">\(t_j\le t&lt;t_{j+1}\)</span>. For <span class="arithmatex">\(t\ge t_1\)</span>, we have</p>
<div class="arithmatex">\[
\begin{align*}
S(t) &amp;= P[T&gt;t] = P[T&gt;t_i, \forall i = 1, ..., j] \\
&amp; = P[T\ge t_1] P[T&gt;t_1|T\ge t_1] P[T&gt;t_2 | T&gt;t_1] ... P[T&gt;t_j|T&gt;t_{j-1}]
\end{align*}
\]</div>
<p>where we used the fact that <span class="arithmatex">\(P[T\ge t_1]=1\)</span>. Notice that <span class="arithmatex">\(\{T&gt;t_{i-1}\}= \{T\ge t_i\}\)</span>, hence</p>
<div class="arithmatex">\[
S(t) = \prod_{t_j \leq t} \left(1 - h(t_j)\right)
\]</div>
<p>Note that <span class="arithmatex">\( H(t) \neq -\log S(t) \)</span> here; instead, <span class="arithmatex">\( -\log S(t) = \sum_{t_j \leq t} -\log(1 - h(t_j)) \)</span>, which differs from <span class="arithmatex">\( H(t) \)</span>.</p>
<p>Again given an estimator of <span class="arithmatex">\(h\)</span> (note this <span class="arithmatex">\(h\)</span> is different from the <span class="arithmatex">\(h\)</span> in the continuous case), one can estimator <span class="arithmatex">\(S\)</span> through this relation.</p>
<p><strong>Other cases</strong>:</p>
<p>For mixed distributions with both continuous and discrete components, <span class="arithmatex">\( H(t) \)</span> combines integrals over continuous regions and sums over discrete jumps.
But it can get more interseting, think Cantor's function (devil's staircase), how can we  express the hazard differently?</p>
<h2 id="right-cencoring">Right-cencoring</h2>
<p>In medical applications, it is often necessary to incorporate a censoring distribution on top of the time-to-event distribution.
Let <span class="arithmatex">\(C\)</span> denote a nonnegative random variable and assume that the observation is <span class="arithmatex">\(Y = \min(T,C)\)</span> and <span class="arithmatex">\(\Delta = I(T\le C)\)</span>.
The indicator evaluates to 1 if the event happens no later than the censoring time (eg dead at time <span class="arithmatex">\(Y\)</span>), and 0 otherwise (eg alive but left the trial at time <span class="arithmatex">\(Y\)</span>). Typically one assume independence between <span class="arithmatex">\(T\)</span> and <span class="arithmatex">\(C\)</span>. What we really cares about is the time to event distribution which is not observed directly.
How to estimate the hazard (hence the survival function from discussion above) in such case?</p>
<p>It is a nice exercise to show that the independence assumption yields (see note<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> for derivation) </p>
<div class="arithmatex">\[
H_T(t) = \int_0^t \frac{dF_{Y,1}(u)}{S_Y(u^-)}
\]</div>
<p>where <span class="arithmatex">\(H_T\)</span> is the cumulative hazard function of <span class="arithmatex">\(T\)</span> and <span class="arithmatex">\(F_{Y,1}(u)=P[Y\le u, \Delta=1]\)</span>.
Now the whole thing is estimable by replacing all terms by their empirical counterpart,
which is</p>
<div class="arithmatex">\[
\hat H_T(t) = \sum_{i=1}^n \frac{\Delta_i I(Y_i\le t)}{\sum_{j} I(Y_j\ge Y_i)}.
\]</div>
<p>Simple observations about the function <span class="arithmatex">\(\hat H_T\)</span>:</p>
<ol>
<li>piecewise constant</li>
<li>right continuous</li>
<li>it jumps and only jumps at <span class="arithmatex">\(T_i\)</span> when <span class="arithmatex">\(\Delta_i=1\)</span> (equivalently <span class="arithmatex">\(T_i=Y_i\)</span>)</li>
<li>those <span class="arithmatex">\(T_i\)</span> with <span class="arithmatex">\(\Delta_i=1\)</span> do not have to be distinct, it is possible that <span class="arithmatex">\(T_i=T_j, \Delta_i=\Delta_j=1\)</span> for some <span class="arithmatex">\(i\neq j\)</span>.</li>
</ol>
<p>Let <span class="arithmatex">\(\{t_1, ...,t_m\} = \mbox{set}(\{T_i: \Delta_i=1\})\)</span>. We conclude that <span class="arithmatex">\(\hat H\)</span></p>
<ul>
<li>jumps at all <span class="arithmatex">\(t_i\)</span></li>
<li>with magnitude <span class="arithmatex">\(D_i/N_i\)</span> where <span class="arithmatex">\(D_i = \sum_j I(T_j=t_i, \Delta_j = 1)\)</span> is the number of observed events at time <span class="arithmatex">\(t_i\)</span>, and <span class="arithmatex">\(N_i=\sum_{j}I(Y_j\ge t_i)\)</span> is the
number of invididuals at risk just before <span class="arithmatex">\(t_i\)</span></li>
</ul>
<p>Summing over these ratios gives an equivalent expression</p>
<div class="arithmatex">\[
\hat H_T(t) = \sum_{i:t_i\le t} \frac{D_i}{N_i}.
\]</div>
<p>Let's recap: we estimate the hazard of <span class="arithmatex">\(T\)</span> using empirical distribution <span class="arithmatex">\(Y\)</span>
and empirical conditional distribution of <span class="arithmatex">\(Y\)</span> given <span class="arithmatex">\(\Delta=1\)</span>, then using the general relationship
between hazard and survival function to get an estimate of the survival function of <span class="arithmatex">\(T\)</span>
so we come full circle!</p>
<p>We have thus two estimators for the survival function of <span class="arithmatex">\(T\)</span>.</p>
<div class="arithmatex">\[
\begin{align*}
\hat S_T^{\rm{NA}}(t) &amp;= \exp( - \hat H_T(t)) \\
\hat S_T^{\rm{KM}}(t) &amp;= \prod_{t_i\le t} (1 - \frac{D_i}{N_i})
\end{align*}
\]</div>
<p>where KM stands for Kaplan-Meier and NA for Nelson-Aalen.</p>
<h2 id="cox-proportional-hazard-model">Cox proportional hazard model</h2>
<p>So far we have discussed observation of time-to-event data (censored or not) without covariate effect.
Cox PH model incorporates the covariate effect into the modelling of hazard.</p>
<div class="admonition info">
<p class="admonition-title">Fun fact</p>
<p>Google scholar reported 63k citations [data as of 11 Feb 2025] of the paper in 1972 by Cox <sup id="fnref:cox"><a class="footnote-ref" href="#fn:cox">2</a></sup> on his nowadays called "proportional hazard model".
Some says that this is the 2nd most cited papers in science, but that is probably not true any more
given that the deep learning industry has exploded the number of publications
e.g. the transformer paper <sup id="fnref:att"><a class="footnote-ref" href="#fn:att">3</a></sup> has 152k citations now, which was published in 2017.</p>
</div>
<p>Anyhow, Cox proportional hazard model remains the de facto standard model in survival analysis. It assumes a semiparametric form for the
hazard (assuming the hazard measure absolutely continuous)</p>
<div class="arithmatex">\[
h_{T|X}(t|x) = h_0(t) \exp(\beta\cdot x) \quad t&gt;0, \, x\in \RR^p.
\]</div>
<p>It is proportional with regard to the change of covariate <span class="arithmatex">\(x\)</span> for each invididual i.e. <span class="arithmatex">\(\frac{h(t|x)}{h(t|x+\delta)}\)</span> is constant over time. This is a strong assumption yet quite flexible because
<span class="arithmatex">\(h_0\)</span> is an arbitrary function and it allows for (parametric) covariate effect.</p>
<p>Estimation and hypothesis testing of <span class="arithmatex">\(\beta\)</span> is obviously of utmost importance. This is done by maximizating partial likelihood (likelihood conditioning on the occurence time of the observed events, due to PH assumption, we have only <span class="arithmatex">\(\beta\)</span> in the partial likelihood). The exposition of some lecture notes<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">4</a></sup> is very clear so I will not waste tokens on it.
See also the notes mentioned before<sup id="fnref2:1"><a class="footnote-ref" href="#fn:1">1</a></sup> for a slightly different perspective.</p>
<h2 id="evaluating-models">Evaluating models</h2>
<p>Having estimated the beta parameters in the Cox PH model, we can rank the riskiness of individuals using 
<span class="arithmatex">\(g(x)= x\cdot\hat\beta\)</span> which assigns the same ranking to individuals as with the hazard model at any point in time, 
thanks to the PH assumption and the monotonicity of exponential function. </p>
<p>A higher risk score translates to a shorter time to event, while a lower risk score translates to a longer time to event. 
A natural evaluation metric
is the quality of this ranking. One widely used measure of this type is the concordance probability. 
The idea is to capture the probability that 
a pair of independent samples <span class="arithmatex">\((T_1,C_1,X_1), (T_2,C_2,X_2)\)</span> are ordered correctly by the risk scores <span class="arithmatex">\(g(X_1)\)</span> and <span class="arithmatex">\(g(X_2)\)</span>. 
To formulate this precisely, introduce for <span class="arithmatex">\(i\in \{1,2\}\)</span> the events</p>
<div class="arithmatex">\[
\begin{align*}
E_i &amp;= \{T_i&lt;\max(T_1,T_2)\} \\
F_i &amp;= \{g(X_i)&gt;\min(g(X_1),g(X_2))\}
\end{align*}
\]</div>
<p>Clearly <span class="arithmatex">\(E_1\cup E_2 = \{T_1\neq T_2\}\)</span>. </p>
<p>The concordance probability is </p>
<div class="arithmatex">\[
\begin{equation}
\label{e-cpop}
P[ \cup_{i=1}^2 (E_i\cap F_i) | E_1\cup E_2 ] = \frac{ P[F_1 \cap E_1] + P[F_2 \cap E_2]}{P[E_1]+P[E_2]}
\end{equation}
\]</div>
<p>Note however that <span class="arithmatex">\(T_1,T_2\)</span> are not always observable. To relate with the observable <span class="arithmatex">\(Y\)</span> and <span class="arithmatex">\(\Delta\)</span> defined <a href="#right-cencoring">earlier</a>,
observe that </p>
<div class="arithmatex">\[
\begin{align*}
E_1 =&amp; \{T_1&lt;T_2\} \\
=&amp;\{\Delta_1=1, \Delta_2=1, Y_1&lt;Y_2\} \\
&amp;\cup \{\Delta_1=1, \Delta_2=0, Y_1&lt;T_2\} \\ 
&amp;\cup \{\Delta_1=0, \Delta_2=1, T_1&lt;Y_2\} \\
&amp;\cup \{\Delta_1=0, \Delta_2=0, T_1&lt;T_2\} \\
\supset&amp; \{\Delta_1 = 1, Y_1&lt;Y_2\} =:D_1
\end{align*} 
\]</div>
<p>and similarly <span class="arithmatex">\(E_2\supset \{\Delta_2 = 1, Y_1&gt;Y_2\}=: D_2\)</span>.</p>
<p>The standard C-index of Harrell is <em>not</em> a consistent estimator of <span class="arithmatex">\(\eqref{e-cpop}\)</span>, but rather one that estimates analogous  probability with <span class="arithmatex">\(D_i\)</span> in place of <span class="arithmatex">\(E_i\)</span>. More concretely, it
is the proportion of concordant pairs with the smaller observation being the event time (<span class="arithmatex">\(\Delta=1\)</span>)
 amongst all pairs with 
with smaller one being the event time (aka the comparable pairs). One way to address the inconsistency is the CPE method<sup id="fnref:cpe"><a class="footnote-ref" href="#fn:cpe">5</a></sup> which is robost with 
regard to how censoring is performed. Yet another proposal is the C-index IPCW<sup id="fnref:ipcw"><a class="footnote-ref" href="#fn:ipcw">6</a></sup> which is a weighted version of C-index using some consistent estimate of the survival function of the censoring distribution in the weights. </p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><a href="https://faculty.washington.edu/yenchic/short_note/note_hazard.pdf">https://faculty.washington.edu/yenchic/short_note/note_hazard.pdf</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:cox">
<p><a href="https://www.medicine.mcgill.ca/epidemiology/hanley/c626/cox_jrssB_1972_hi_res.pdf">https://www.medicine.mcgill.ca/epidemiology/hanley/c626/cox_jrssB_1972_hi_res.pdf</a>&#160;<a class="footnote-backref" href="#fnref:cox" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:att">
<p><a href="https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf">https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</a>&#160;<a class="footnote-backref" href="#fnref:att" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p><a href="https://web.stanford.edu/class/archive/stats/stats200/stats200.1172/Lecture28.pdf">https://web.stanford.edu/class/archive/stats/stats200/stats200.1172/Lecture28.pdf</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:cpe">
<p><a href="https://www.mskcc.org/sites/default/files/node/2246/documents/cpe.pdf">https://www.mskcc.org/sites/default/files/node/2246/documents/cpe.pdf</a>&#160;<a class="footnote-backref" href="#fnref:cpe" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:ipcw">
<p><a href="https://biostats.bepress.com/cgi/viewcontent.cgi?referer=&amp;httpsredir=1&amp;article=1108&amp;context=harvardbiostat">https://biostats.bepress.com/cgi/viewcontent.cgi?referer=&amp;httpsredir=1&amp;article=1108&amp;context=harvardbiostat</a>&#160;<a class="footnote-backref" href="#fnref:ipcw" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
  



  


  



      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://www.linkedin.com/in/xiaochuan-yang-088975188/" target="_blank" rel="noopener" title="xiaochuan on LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.youtube.com/@xiaochuanyang" target="_blank" rel="noopener" title="xiaochuan on Youtube" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://x.com/xiaochuandev" target="_blank" rel="noopener" title="xiaochuan on X" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["navigation.indexes", "navigation.instant", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="../../../../js/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>